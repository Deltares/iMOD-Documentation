<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Components: QGIS and iMOD plugin">

<title>iMOD Suite - Abbeyfeale</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tutorial_Dommel.html" rel="next">
<link href="./tutorial.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="_static/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./_static/iMOD-doc-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">iMOD Suite</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./viewer.html"> 
<span class="menu-text">iMOD Viewer</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./python.html"> 
<span class="menu-text">iMOD Python</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./coupler.html"> 
<span class="menu-text">iMOD Coupler</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./tutorial.html" aria-current="page"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./practical.html"> 
<span class="menu-text">Practical tips</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Deltares/iMOD-Documentation"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tutorial_Abbeyfeale.html">Abbeyfeale</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"> Tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial_Abbeyfeale.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Abbeyfeale</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial_Dommel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dommel</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial_wq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conceptual fresh-salt model</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#description" id="toc-description" class="nav-link active" data-scroll-target="#description">Description</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#introduction-schematization-ground-water-model-abbeyfeale" id="toc-introduction-schematization-ground-water-model-abbeyfeale" class="nav-link" data-scroll-target="#introduction-schematization-ground-water-model-abbeyfeale">Introduction: schematization ground water model Abbeyfeale</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#imod-python" id="toc-imod-python" class="nav-link" data-scroll-target="#imod-python">iMOD Python</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Abbeyfeale</h1>
</div>

<div>
  <div class="description">
    Components: QGIS and iMOD plugin
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description">Description</h2>
<p>In this tutorial, you will learn the following:</p>
<ol type="1">
<li>Basic usage of QGIS</li>
<li>Draw a cross-section in the iMOD QGIS plugin</li>
<li>View time series in the iMOD QGIS plugin</li>
<li>Run a Python script in a shell</li>
</ol>
</section>
<section id="objective" class="level2">
<h2 class="anchored" data-anchor-id="objective">Objective</h2>
<p>In this Tutorial you learn the basics of iMOD-Suite. Therefore, we load and analyze a few file types. The files describe geohydrologic datasets for an area in the town of Abbeyfeale, Ireland. For this area we will develop a simple groundwater model using Python. Therefore, we start a command prompt for Python. From that command prompt you will run 7 prepared Python scripts. Each script handles a single step in the MODFLOW 6 modelling process: the preprocessing of basic data, the creation of MODFLOW 6 input files, running of the MODFLOW6 model and analyzing the results. The files created with each step are analyzed in QGIS.</p>
</section>
<section id="introduction-schematization-ground-water-model-abbeyfeale" class="level2">
<h2 class="anchored" data-anchor-id="introduction-schematization-ground-water-model-abbeyfeale">Introduction: schematization ground water model Abbeyfeale</h2>
<p>Abbeyfeale is a historic market town in the County Limerick, Ireland. The local authorities are worried about the effects of drier summers on groundwater levels. A simple groundwater model can provide them with a quantification of the expected groundwater level decline. Geology: much of Ireland can be considered as relatively glacial subsoil (typically &lt; 15 m thick) overlying very hard old fractured rock. For basic models this can be represented as one layer for the subsoil and one layer for bedrock.</p>
<div id="fig-figure_topo-Abbeyfeale_simplified-Abbeyfeale-model" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_topo-Abbeyfeale_simplified-Abbeyfeale-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_topo-Abbeyfeale_simplified-Abbeyfeale-model.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_topo-Abbeyfeale_simplified-Abbeyfeale-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Village of Abbeyfeale and the components of the simplified Abbeyfeale model
</figcaption>
</figure>
</div>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<ol class="example" type="1">
<li>Launch QGIS from your START menu, your desktop or click on …\QGIS3.24.0\bin\qgis-bin.exe.</li>
</ol>
<hr>
<blockquote class="blockquote">
<p><strong>Intermezzo QGIS language</strong> Perhaps your QGIS was installed in another language than English. Because the Tutorial refers to the English version, let’s change than to English.</p>
<ol type="a">
<li>From the main menu click on <em>Settings</em> and select <em>Options</em>. (e.g.&nbsp;in Dutch <em>Extra</em> and <em>Opties</em>)</li>
<li>In the new window go to the <em>General section</em> on the left.</li>
<li>From the drop-down menu <em>“User interface translation”</em> select <em>American English</em> and click on OK.</li>
<li>Close QGIS and open it again to activate your language change.</li>
</ol>
</blockquote>
<hr>
<p>We start with the creation of a new QGIS project.</p>
<ol start="2" class="example" type="1">
<li>From the main menu click on <em>Project</em> and select <em>New</em>.</li>
</ol>
<p>For navigation purposes, let us load the universal topography of Open Street Map (OSM).</p>
<ol start="3" class="example" type="1">
<li>Check on the left site if the panel “Browser” is available. If not, select View from the main menu, go to <em>Panels</em> and select <em>Browser Panel</em>.</li>
<li>The Browser panel contains the group <em>XYZ Tiles</em>. From that group double click on the item <em>OpenStreetMap</em>. This layer is now added to the panel <em>Layers</em>. To display this dataset an internet connection is needed. So if that is the situation, you will see the world map in the display.</li>
</ol>
<p>The data we use in this part of the training is from Ireland, so next we select the appropriate projection. (In case you missed the download instructions for the Tutorial data, visit the start page <a href="./index.html">iMOD Suite Tutorial</a>).<br>
</p>
<ol start="5" class="example" type="1">
<li>From the main menu click on <em>Project</em> and select <em>Properties</em>.</li>
<li>In the <em>Properties</em> window select the category <em>CRS</em>, search for “EPSG:2157” and you find “IRENET95 / Irish Transverse Mercator”. Select this option and click the <em>Apply</em> button, followed by the <em>OK</em> button to close the window.</li>
</ol>
<p>Let us now open a series of basic files in QGIS. We start with a digital elevation map.</p>
<ol start="7" class="example" type="1">
<li>Go to <em>Layer</em> in the main menu, select <em>Add Layer</em> and pick the option <em>Add Raster Layer</em>.</li>
<li>In the section <em>Source</em> click on the <img src="figures/tutorial/viewer/button_select.png" class="img-fluid"> button and select the file “…\iMOD-Suite-Tutorial_01\data\1-external\topography\Abbeyfeale DTM.tif”. GeoTIFF is a common file format.</li>
<li>Click the <em>Add</em> button and the layer is added to the panel <em>Layers</em>.</li>
<li>Click <em>Close</em> to leave the window.</li>
<li>In the panel <em>Layers</em> select the layer “Abbeyfeale DTM” and click the <img src="figures/tutorial/viewer/button_zoomtolayer.png" class="img-fluid"> button to zoom in to the layer.</li>
</ol>
<p>We see the contours of a river, but the legend is gray only by default. Let’s change that.</p>
<ol start="12" class="example" type="1">
<li>Double click on the layer “Abbeyfeale DTM”. The window “Layer Properties” opens.</li>
<li>Select the group <em>Symbology</em>.</li>
<li>From the dropdown menu <em>Render Type</em> select the type <em>Singleband pseudocolor</em>.</li>
<li>Be sure a Color Ramp is selected as well.</li>
<li>Make sure the dropdown menu <em>Interpolation</em> shows Linear and the dropdown menu <em>Mode</em> shows <em>Continuous</em>.</li>
<li>Click <em>Apply</em> to change the colors and <em>OK</em> to close the window.</li>
<li>You can zoom in and out with the scroll button on your mouse or navigate with the buttons in the main menu: <img src="figures/tutorial/viewer/button_zoom-menu.png" class="img-fluid"></li>
</ol>
<p>Your screen might look like <a href="#fig-figure_DTM-in-QGIS" class="quarto-xref">Figure&nbsp;2</a></p>
<div id="fig-figure_DTM-in-QGIS" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_DTM-in-QGIS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_DTM-in-QGIS.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_DTM-in-QGIS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: DTM in QGIS with the topography of OpenStreetMap Cross as background
</figcaption>
</figure>
</div>
<p>Let us save this project to be able to return to is later or in case of a crash of QGIS.</p>
<ol start="19" class="example" type="1">
<li>Go to <em>Project</em> in the main menu, select <em>Save As</em> and select a folder and a file name for your project, e.g.&nbsp;“…\iMOD-Suite-Tutorial_01\tutorial1.qgz”</li>
</ol>
<p>Do you like to see the values of the DTM under you mouse? You need a QGIS plugin “Value Tool”. Many additional helpful tools are available as QGIS plugin, just like the Deltares iMOD Plugin.</p>
<ol start="20" class="example" type="1">
<li>Go to <em>Plugins</em> from the main menu and select <em>Manage and Install Plugins… </em> and a window opens.</li>
<li>On the left, select the group <em>All</em> to see all available plugins.</li>
<li>Search for “iMOD” and see that the iMOD plugin is successfully installed.</li>
<li>Check if version 0.2.3 is installed. If not, click the button to Upgrade the iMOD Plugin.</li>
<li>Search for “Value Tool”, install it and <em>Close</em> the Plugins window.</li>
</ol>
<p><br>
</p>
<div id="fig-button_iMOD-Toolbar" class="quarto-figure quarto-figure-left quarto-float anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-button_iMOD-Toolbar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/button_iMOD-Toolbar.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:35.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-button_iMOD-Toolbar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: iMOD plugin toolbar
</figcaption>
</figure>
</div>
<p>The tool is now visible as a panel on the left and as the <em>Value Tool</em> button (<img src="figures/tutorial/viewer/button_valuetool.png" class="img-fluid" style="width:4.0%">) in a panel on the top of QGIS.</p>
<ol start="25" class="example" type="1">
<li>Hover over the DTM and in the “Value Tool” panel you see the value at your mouse location.</li>
</ol>
<div id="fig-figure_ValueTool-in-QGIS" class="quarto-figure quarto-figure-left quarto-float anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_ValueTool-in-QGIS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_ValueTool-in-QGIS.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_ValueTool-in-QGIS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Example panel Value Tool
</figcaption>
</figure>
</div>
<p>Next step is to load a polygon file representing the recharge zones in the project area.</p>
<ol start="26" class="example" type="1">
<li>Go to <em>Layer</em> in the main menu, select <em>Add Layer</em> and pick the option <em>Add Vector Layer</em>.</li>
<li>In the section Source click on the <img src="figures/tutorial/viewer/button_select.png" class="img-fluid"> button and select the file “…\iMOD-Suite-Tutorial_01\data\1-external\recharge\clipped_recharge.shp”. The ESRI Shapefile is a common file format.</li>
<li>Click the <em>Add</em> button and the layer is added to the panel <em>Layers</em>.</li>
<li>Click <em>Close</em> to leave the window.</li>
</ol>
<p>We see the contours of zones with a single color. Let’s change that.</p>
<ol start="30" class="example" type="1">
<li>Double click on the layer “clipped_recharge”. The window “Layer Properties” opens.</li>
<li>Select the group <em>Symbology</em>.</li>
<li>From the upper dropdown menu select <em>Categorized</em>.</li>
<li>From the dropdown <em>Value</em> select RECH_MM_YR.</li>
<li>From the dropdown <em>Color ramp</em> select Viridis.</li>
<li>Click on the button <em>Classify</em> to create the legend.</li>
<li>Click <em>Apply</em> to change the colors and <em>OK</em> to close the window.</li>
</ol>
<p>There is also an ESRI Shapefile with the rivers in the project area. Feel free to download that file (“…\iMOD-Suite-Tutorial_01\data\1-external\rivers\WATER_RivNetRoutes.shp”) in the same way.</p>
<p>After loading raster and polygon layers, let us now load a point file with boreholes. This time, the file format (*.IPF) is not a common file standard but developed by Deltares because the file includes associated borelog information. We must load the IPF file with the iMOD plugin.</p>
<ol start="37" class="example" type="1">
<li>One of the QGIS toolbars is the iMOD Toolbar. There you find al the iMOD plugin tools. Click on the <em>Open IPF</em> button (<img src="figures/tutorial/viewer/button_iMOD-Open-IPF.png" class="img-fluid" style="width:3.0%">) and a window will open.</li>
<li>Click on the <img src="figures/tutorial/viewer/button_select.png" class="img-fluid" style="width:3.0%"> button and select the IPF “…\iMOD-Suite-Tutorial_01\data\1-external\boreholes\BOREHOLES.IPF”.</li>
<li>Click the <em>Add</em> button and the IPF file is added in the panel <em>Layers</em>.</li>
</ol>
<p><strong>NOTE</strong>: If the points appear to be somewhere else on the map, e.g.&nbsp;Africa, make sure both your project and your layer have the correct CRS (EPSG:2157).</p>
<ol type="a">
<li>Check if the project CRS on the lower right corner still is <img src="figures/tutorial/viewer/button_epg2157.png" class="img-fluid" style="width:25.0%">. Otherwise double click this area and change the EPSG.</li>
<li>Check if the layer CSR is correct and therefor double click on the BOREHOLES layer.</li>
<li>In the window <em>Layer Properties</em> go to the section <em>Source</em>.</li>
<li>In the dropdown menu <em>“Assigned Coordinate Reference System (CRS)”</em> select EPSG:2157.</li>
</ol>
<ol start="40" class="example" type="1">
<li>Right-click layer BOREHOLES in the <em>Layers</em> panel and click “Show labels”. This will label the points with the borelog identifier.</li>
</ol>
<p>The bore log for each borehole can only be displayed in a cross-section. Therefore, we activate the iMOD cross-section tool.</p>
<ol start="41" class="example" type="1">
<li><p>On the iMOD Toolbar select the <em>Cross section</em> button (<img src="figures/tutorial/viewer/button_iMOD-Cross-section.png" class="img-fluid" style="width:3.0%">) to start the iMOD Cross Section tool. In the empty cross-section we can add a selection of (geological) layers. For now, we only select the boreholes.</p></li>
<li><p>On the iMOD Toolbar click on the button <em>Select location</em> and draw your cross-section line from north to south following the 6 central borehole locations. Add points to the line with your left mouse button and close the line with the right button. You can remove and redraw the line by clicking the <em>Select location</em> button again.</p></li>
<li><p>In the field <em>Search buffer</em> increase the buffer along the line to 1000m. Now a yellow shade is visible around your line selecting all the available points within.</p></li>
<li><p>From the dropdown menu on the left of this toolbar, select the layer BOREHOLES if not selected already. From the borelog we want to plot the variable LITHOLOGY, which is already selected in the Variable dropdown menu (it is the only available variable).</p></li>
<li><p>Click the button <em>Add</em> to add this layer to the cross-section manager below.</p></li>
<li><p>Click the button <em>Plot</em> to draw this layer in the cross section.</p></li>
</ol>
<p>To complete the cross section, let us also add the digital elevation map to the cross-section manager.</p>
<ol start="47" class="example" type="1">
<li>From the dropdown menu now select the layer Abbeyfeale DTM. We do not need to select a Variable</li>
<li>Click the button <em>Add</em> to add this layer to the cross-section manager below.</li>
<li>Click the button <em>Plot</em> to draw both layers in the cross section.</li>
</ol>
<p>Your screen might look like <a href="#fig-figure_Crosssection-with-borelogs" class="quarto-xref">Figure&nbsp;5</a> although the colors are different than in your screen. Feel free to use the column <em>Symbology</em> to change the legend.</p>
<p><strong>NOTE</strong>: If no lines appear on your screen, make sure you have set your project CRS to EPSG:2157 (see earlier step).</p>
<div id="fig-figure_Crosssection-with-borelogs" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_Crosssection-with-borelogs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_Crosssection-with-borelogs.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_Crosssection-with-borelogs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Cross section with borelogs and DEM
</figcaption>
</figure>
</div>
<p>For now, we leave QGIS and the iMOD Plugin to return later.</p>
<ol start="50" class="example" type="1">
<li>Save your QGIS project (Ctrl+S) and keep the QGIS application open.</li>
</ol>
</section>
<section id="imod-python" class="level2">
<h2 class="anchored" data-anchor-id="imod-python">iMOD Python</h2>
<p>This is the moment where we start with Python. With the help of the iMOD Python package you will create a simple MODFLOW6 model and run it.</p>
<ul>
<li>All input we use for this simple model is available in your tutorial folder “…\iMOD-Suite-Tutorial_01\data\1-external\..”“. There you find the spatial data we loaded to QGIS, and there is a CSV file containing all single parameter values: “parameters.csv”.</li>
<li>All steps, from the preparation of the model input to visualization of the results, are available in separate Python scripts. You find the scripts for each phase in the folder and subfolders within “..\iMOD-Suite-Tutorial_01\src\..”</li>
</ul>
<ol start="51" class="example" type="1">
<li>Click on the windows START button and type <em>Deltaforge prompt</em>. Click on the app and a black DOS window will start. <em>[for Python experts: with this prompt a python environment is activated containing the iMOD python package as well as Snakemake (workflow manager)]</em>.</li>
</ol>
<p>From this DOS window we will run the different python scripts (*.py files). For the scripts to work properly, we need to navigate to the correct folder location.</p>
<ol start="52" class="example" type="1">
<li>In the DOS window type the letter of the drive you work on (e.g.&nbsp;C: or D:) and press ENTER.</li>
<li>Navigate to the correct main tutorial folder with CD (change directory). E.g. “CD c:\imod\training\iMOD-Suite-Tutorial_01” and press ENTER.</li>
</ol>
<p>TIP: After copying your path, you can paste your path in the prompt window with CTRL+V.</p>
<p>Now we run 4 scripts to convert basic data into an interim model format (NetCDF), ready to create MODFLOW6 input files. </p>
<ins>
Script 1 – template
</ins>
<p>This script opens the DTM file, uses its extent for the model boundary and sets the cell size to 40m.</p>
<ol start="54" class="example" type="1">
<li>In the Deltaforge prompt type the command: <em>Python src\1-prepare\1-create-template-grid.py</em> and press ENTER.</li>
</ol>
<p><img src="figures/tutorial/viewer/figure_iMODforge_prompt.png" class="img-fluid"></p>
<p>Results 1: The result is a raster file (NetCDF format) describing the mask of our model (extent and cell size) as well as our DTM scaled up to the size of the model mask.</p>
<ol start="55" class="example" type="1">
<li><strong>Optional step</strong>. Load the topography_raster.nc file into QGIS. The file is in the folder “…\iMOD-Suite-Tutorial_01\data\2-interim”.</li>
</ol>
<ins>
Script 2 – River
</ins>
<p>This script opens a shape file with river elements. It rasterizes it to the project cell size and adds a default river depth (1 m) and bottom resistance.</p>
<ol start="56" class="example" type="1">
<li>In the Deltaforge prompt type the command: <em>Python src\1-prepare\2-create-river-system.py</em> and press ENTER.</li>
</ol>
<p>Results 2: The result is a raster file (NetCDF format) for the river data, containing data for the parameters Stage, Bottom and Conductance.</p>
<ol start="57" class="example" type="1">
<li>Load the file “..\iMOD-Suite-Tutorial_01\data\2-interim\river_raster.nc” into QGIS via the menu <em>Layer &gt; Add Layer &gt; Add Raster Layer</em>. From the interim window you see that the NC files contains 3 river parameters.</li>
<li>Click on the button <em>Add Layers</em> and click <em>Close</em> to close the Data Source Manager.</li>
</ol>
<ins>
Script 3 – Recharge
</ins>
<p>This script opens the shape file with recharge zones (polygons) containing the recharge in mm per year. The recharge zones are rasterized to the project extent and cell size. Finally the script adds a seasonal forcing (sine function) resulting in a time series of daily recharge values for 1 year.</p>
<ol start="59" class="example" type="1">
<li>In the Deltaforge prompt type the command: <em>Python src\1-prepare\3-create-recharge.py</em> and press ENTER.</li>
</ol>
<p>Results 3: The result is a mesh file (NetCDF format) for the recharge data, containing data for 365 days. This NC file must be loaded as mesh in stead of a raster.</p>
<ol start="60" class="example" type="1">
<li>From the menu <em>Layer &gt; Add layer &gt; Add Mesh Layer…</em> load the file “…\iMOD-Suite-Tutorial_01\data\2-interim\recharge_mesh.nc” into QGIS. From the panel Layer you can see that the file is a timeseries because a small clock symbol is visible <img src="figures/tutorial/viewer/button_clockquestion.png" class="img-fluid" style="width:8.0%">.</li>
</ol>
<p>There are 2 ways to visualize this recharge over time:</p>
<ol type="1">
<li>animation over time;</li>
<li>timeseries at location.</li>
</ol>
<p>Let’s now activate the panels for both methods.</p>
<ol start="61" class="example" type="1">
<li>For the animation over time, activate the <em>Temporal Control Panel</em> with the clock button <img src="figures/tutorial/viewer/button_TemporalControllerPanel.png" class="img-fluid" style="width:4.0%"> on the Map Navigation Toolbar (<img src="figures/tutorial/viewer/button_TemporalControllerPanel_plus.png" class="img-fluid" style="width:18.0%">).</li>
<li>For timeseries at location activate the Timeseries panel with the <em>Timeseries</em> button (<img src="figures/tutorial/viewer/button_iMOD-TimeSeries.png" class="img-fluid" style="width:4.0%"> ) on the iMOD Toolbar.</li>
</ol>
<p>Your display should look similar with <a href="#fig-figure_RCH-in-TemporalController-and-TimeSeriesPlot" class="quarto-xref">Figure&nbsp;6</a>, except for the red line below.</p>
<ol start="63" class="example" type="1">
<li>In the <em>Temporal Controller</em> panel click the green play button (<img src="figures/tutorial/viewer/button_TemporalControllerPanel-menu.png" class="img-fluid" style="width:12.0%">). Navigation buttons appear.</li>
<li>Increase the <em>Step</em> from 1 to 14 days and start the animation with a click on the <em>Play</em> button (<img src="figures/tutorial/viewer/button_TemporalControler-play.png" class="img-fluid" style="width:4.0%">).</li>
<li>In the iMOD time series panel be sure the layer RECHARGE_MESH is loaded. The mesh only contains a single variable: Recharge.</li>
<li>Click the button <em>Select Points</em>, your mouse changes into a <img src="figures/tutorial/viewer/mouse_plus.png" class="img-fluid">. Be sure <em>Update on Selection</em> is checked and hover over the mesh. The graph shows the timeseries at the location of your mouse.</li>
<li>Deselect the checkbox <em>Update on Selection</em>.</li>
<li>Click the button <em>Select Points</em> (your mouse becomes a <img src="figures/tutorial/viewer/mouse_plus.png" class="img-fluid"> and with the left mouse button select 3 points ad random.</li>
<li>Finally click the <em>Plot</em> button and the 3 timeseries are added to the chart. Colors can be changed.</li>
</ol>
<div id="fig-figure_RCH-in-TemporalController-and-TimeSeriesPlot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_RCH-in-TemporalController-and-TimeSeriesPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_RCH-in-TemporalController-and-TimeSeriesPlot.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_RCH-in-TemporalController-and-TimeSeriesPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Recharge data analysed in the Temporal Controller (QGIS) and the Time Series Plot tool (iMOD)
</figcaption>
</figure>
</div>
<ins>
Script 4 – Geohydrology
</ins>
<p>This script reads default parameter values from the file “parameters.csv” in order to create a NetCDF file with top and bottom of 3 layers including the geohydraulic parameters. The default values are: </p>
<table class="table">
<caption>Parameter values</caption>
<thead>
<tr class="header">
<th>Parameter</th>
<th style="text-align: left;">Value</th>
<th style="text-align: center;">Quantity</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K_tz</td>
<td style="text-align: left;">5.9</td>
<td style="text-align: center;">m/d</td>
<td style="text-align: left;">Permeability Transition Zone</td>
</tr>
<tr class="even">
<td>K_sb</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: center;">m/d</td>
<td style="text-align: left;">Permeability Shallow Bed rock</td>
</tr>
<tr class="odd">
<td>K_db</td>
<td style="text-align: left;">0.014</td>
<td style="text-align: center;">m/d</td>
<td style="text-align: left;">Permeability Deep Bed rock</td>
</tr>
<tr class="even">
<td>D_tz</td>
<td style="text-align: left;">1</td>
<td style="text-align: center;">m</td>
<td style="text-align: left;">Thickness transition zone</td>
</tr>
<tr class="odd">
<td>D_sb</td>
<td style="text-align: left;">5</td>
<td style="text-align: center;">m</td>
<td style="text-align: left;">Thickness shallow bed rock zone</td>
</tr>
<tr class="even">
<td>D_db</td>
<td style="text-align: left;">50</td>
<td style="text-align: center;">m</td>
<td style="text-align: left;">Thickness deep bed rock zone</td>
</tr>
</tbody>
</table>
<ol start="70" class="example" type="1">
<li>In the Deltaforge prompt type the command: <em>Python src\1-prepare\4-create-hydrogeology.py</em> and press ENTER.</li>
</ol>
<p>Results 4: The result is a mesh file (NetCDF format) for the geohydrological data. This NC file must be loaded as mesh instead of a raster.</p>
<ol start="71" class="example" type="1">
<li>From the menu <em>Layer &gt; Add layer &gt; Add Mesh layer…</em> load the file “…\iMOD-Suite-Tutorial_01\data\2-interim\hydrogeology_mesh.nc” into QGIS.</li>
<li>Double click on the layer name “hydrogeology_mesh” and the window <em>Layer Properties</em> will open.</li>
<li>Click on the group <em>Source</em> on the left, and on the right you see all <em>Available Datasets</em> in this single mesh.</li>
</ol>
<p>Let’s create a cross-section with the permeability plot within each layer.</p>
<ol start="74" class="example" type="1">
<li>First, we must deactivate temporal control. Open the Temporal Control Panel again (<img src="figures/tutorial/viewer/button_TemporalControllerPanel.png" class="img-fluid" style="width:4.0%">), and turn off temporal navigation with the button <img src="figures/tutorial/viewer/button_TemporalControllerPanel-turnoff.png" class="img-fluid" style="width:4.0%">.</li>
<li>On the iMOD Toolbar select the <img src="figures/tutorial/viewer/button_iMOD-Cross-section.png" class="img-fluid" style="width:3.0%"> button to start the iMOD Cross Section tool.</li>
<li>In the iMOD cross-section panel be sure the layer “hydrogeology_mesh” is selected. From the <em>Variable</em> dropdown select <em>permeability</em> and from the Layers dropdown select all layers.</li>
<li>Click the button <em>Add</em> to add this item to the list of chart elements.</li>
<li>Click on the button <em>Select Location</em> and draw a single line over the model area with your left mouse button. Close the line with your right mouse button.</li>
<li>Click the button <em>Plot</em> and the geology along the line colored by permeability is draw in the chart.</li>
</ol>
<p>TIP: If you do not see any line, perhaps the axes are not defined well. To view all data, click you right mouse button in the figure and select the option “View All”. The alternative is to click on the small A symbol (<img src="figures/tutorial/viewer/button_CrossSection-ViewAll.png" class="img-fluid" style="width:3.0%">) in the lower left of the chart.</p>
<p>Your screen might look like <a href="#fig-figure_CrossSectionTool-3layers" class="quarto-xref">Figure&nbsp;7</a>. In case the default legend is not <img src="figures/tutorial/viewer/figure_CrossSectionTool-legend.png" class="img-fluid" style="width:20.0%"> you can change it.</p>
<ol start="80" class="example" type="1">
<li>To change the legend, click on the colored bar in the column <em>symbology</em>.</li>
<li>In the new window go the “Render type” menu and select <em>Unique values</em> and click <em>Apply</em>.</li>
<li>Use the scroll button on your mouse to zoom in order to make the permeability of the thin first layer visible.</li>
</ol>
<div id="fig-figure_CrossSectionTool-3layers" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_CrossSectionTool-3layers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_CrossSectionTool-3layers.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_CrossSectionTool-3layers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Three model layers coloured by permeability in the iMOD cross-section tool
</figcaption>
</figure>
</div>
<ins>
Script 5 – Create MODFLOW 6 input
</ins>
<p>Now the input data for the model are available, it is time to convert the data into the standard MODFLOW6 format. For that conversion a function exists within iMOD Python. We prepared another python script for you to easily do the conversion by running the script in the <em>Deltaforge prompt</em>.<br>
[If you are interested in the content of the script, open it in your Python editor (e.g.&nbsp;Spyder) or a simple Text editor].</p>
<ol start="83" class="example" type="1">
<li>In the <em>Deltaforge prompt</em> type the command: <em>Python src\2-build\5-build-model.py</em> and press ENTER.</li>
</ol>
<p>The result of the script is a folder with the standard MODFLOW 6 input.</p>
<ol start="84" class="example" type="1">
<li>Optional step Visit the folder “…\iMOD-Suite-Tutorial_01\data\3-input” with your file manager. There your find the file MFSIM.NAM. This is the main MODFLOW6 file with references to the other files and settings. The folder GWF_1 contains the model input and later the model results.</li>
</ol>
<ins>
Script 6 – Run the MODFLOW 6 model
</ins>
<p>iMOD Suite uses the official USGS version of MODFLOW 6. The executable is provided with the tutorial database and is available as “…\iMOD-Suite-Tutorial_01\bin\mf6.exe”.</p>
<ol start="85" class="example" type="1">
<li>In the Deltaforge prompt type the command: <em>Python src\3-model\6-run-model.py</em> and press ENTER.<br>
</li>
<li>You can check the logfile of the model in order to see if it was run successful.</li>
<li>Open the file “…\iMOD-Suite-Tutorial_01\data\3-input\mf.sim.lst” in the Text Editor you prefer. Go to the end of the file and see the total run time of the model and a confirmation of a “normal termination of the simulation”.</li>
<li>Open the file “…\iMOD-Suite-Tutorial_01\data\3-input\gwf_1\gwf_1.lst”. At the end of the file you see the Volume Budgets, the water balance for the last stress period.</li>
</ol>
<ins>
Script 7 - Convert the MODFLOW 6 results for QGIS
</ins>
<p>The standard output of MODFLOW6 cannot be loaded into QGIS. Therefore, iMOD Python contains a function to convert the output into NetCDF files.</p>
<ol start="89" class="example" type="1">
<li>In the <em>Deltaforge prompt</em> type the command: <em>Python src\3-model\7-post-process-output.py</em> and press ENTER.</li>
</ol>
<p>The result of this script is a NetCDF file with the calculated head for 365 days.</p>
<ol start="90" class="example" type="1">
<li>Load the file “…\iMOD-Suite-Tutorial_01\data\4-output\hds_mesh.nc” into QGIS.</li>
</ol>
<p>By default, the variable bottom_layer_1 is loaded. We will change the selected variable into Heads and pick a legend specific for plotting of time series.</p>
<ol start="91" class="example" type="1">
<li>Double click on the layer “hds_mesh” to open the <em>Layer Properties window</em>.</li>
<li>Select the group Source on the left and see that the mesh contains several datasets.</li>
<li>Select the group Symbology on the left and select the first tab <em>Dataset</em> (<img src="figures/tutorial/viewer/button_SymbologyDataset.png" class="img-fluid" style="width:3.0%">). Here we can select the group we want to plot, for now it is “head_layer_1”.<br>
</li>
<li>Click on the icon (<img src="figures/tutorial/viewer/button_SymbologyDataset-unselected.png" class="img-fluid" style="width:3.0%">) on the line for “head_layer_1” and change it into (<img src="figures/tutorial/viewer/button_SymbologyDataset-selected.png" class="img-fluid" style="width:3.0%">). Click on Apply.</li>
<li>Select the second tab Contours (<img src="figures/tutorial/viewer/button_SymbologyContours.png" class="img-fluid" style="width:3.0%"> ).</li>
<li>Set the Min value on 40.00 and the Max value on 60.00 in order to see head changes over time.</li>
<li>From the dropdown menu Color Ramp select Turbo and click on OK to close the window.</li>
</ol>
<p>Now we try to show an animation of the variation of calculated Heads over time and as timeseries.</p>
<ol start="98" class="example" type="1">
<li>For the animation over time, activate the Temporal Control Panel with the button (<img src="figures/tutorial/viewer/button_TemporalControllerPanel.png" class="img-fluid" style="width:3.0%">) on the Map Navigation Toolbar.</li>
<li>From you experience with this tool, try to start the animation with timestep of 14 days.</li>
<li>For timeseries at location activate the Timeseries panel with the <em>Timeseries</em> button (<img src="figures/tutorial/viewer/button_iMOD-TimeSeries.png" class="img-fluid" style="width:3.0%">) on the iMOD Toolbar.</li>
<li>From you experience with this tool, select 3 points in the model area and plot the corresponding calculated Heads for layer 1.</li>
</ol>
<div id="fig-figure_Timeseries-Heads-in-3-points" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figure_Timeseries-Heads-in-3-points-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tutorial/viewer/figure_Timeseries-Heads-in-3-points.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figure_Timeseries-Heads-in-3-points-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Calculated head with MODFLOW 6 on 3 points within the model area
</figcaption>
</figure>
</div>
<p>The QGIS part of the tutorial ends here. You can save your QGIS project now.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tutorial.html" class="pagination-link" aria-label="{{< fa solid book >}} Tutorials">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><i class="fa-solid fa-book" aria-label="book"></i> Tutorials</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tutorial_Dommel.html" class="pagination-link" aria-label="Dommel">
        <span class="nav-page-text">Dommel</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>